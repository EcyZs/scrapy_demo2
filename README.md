# 💬 微博评论爬取与情感分析（动态页面）新手项目

## 🎯 项目目标

本项目通过自动化工具 Playwright 实现对微博动态页面中评论内容的抓取，结合自然语言处理工具 SnowNLP 对评论情绪进行分析，最终通过可视化展示用户整体情绪分布。项目涵盖了数据采集、处理、分析和可视化的完整流程，展示了在动态页面环境下的爬虫能力和基础情感分析能力。

---

## 🧰 技术栈

- **Python**：主语言
- **Playwright**：浏览器自动化与接口监听（动态内容提取）
- **pandas**：数据清洗与处理
- **SnowNLP**：中文情感分析
- **matplotlib**：图表可视化

---

## 🛠️ 项目流程

### 1. 目标微博选择

- 示例微博链接：[#灵笼第二季开播# - @灵笼官方](https://weibo.com/6169991913/Pt7VwbdaJ#comment)

### 2. 评论采集（`爬虫.py`）

- 使用 Playwright 自动打开页面并滚动到底，监听评论加载接口。
- 自动加载多页评论，模拟用户行为。
- 支持通过手动复制 Cookie 绕过登录限制。

### 3. 数据处理与清洗

- 提取评论内容、时间、来源等字段。
- 去除重复项、空评论、无效评论。
- 最终结果保存为：`DATA/comments.csv`

### 4. 情感分析与可视化（`情感分析.py`）

- 使用 SnowNLP 对每条评论打分（范围：0~1）
- 根据阈值将评论划分为「正面」「中性」「负面」
- 结果保存为：`DATA/comments_with_sentiment.csv`
- 使用 matplotlib 绘制情绪分布扇形图

---

## 📊 项目亮点

- ✅ **动态页面处理**：Playwright 实现对微博动态加载内容的稳定采集。
- ✅ **完整数据流**：数据采集 → 清洗 → 情感分析 → 可视化。
- ✅ **中文情感分析**：基于 SnowNLP，无需模型训练即可得出可解释的分析结果。
- ✅ **图形展示**：使用 matplotlib 提供直观的用户情绪分布图。

---

## 📁 项目结构

D:.
│ 情感分析.py # 负责情感打分与可视化
│ 爬虫.py # 负责评论采集（Playwright 自动化）
│
└─DATA
├── comments.csv # 原始评论数据
└── comments_with_sentiment.csv # 含情感分析字段的处理结果

![Figure_1](https://github.com/user-attachments/assets/b72befff-c4b7-4ba5-a62f-3445375a2238)
